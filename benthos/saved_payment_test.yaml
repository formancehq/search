tests:
- name: Test saved payment
  target_mapping: './saved_payment.blobl'
  environment:
    INDEX: ledger
  input_batch:
  - content: |
      {
        "date": "2022-03-16T13:11:38.47608275Z",
        "type": "SAVED_PAYMENT",
        "payload":{
          "id": "XXX",
          "reference": "YYY",
          "provider": "stripe"
        }
      }
  output_batches:
  -
    - json_equals: [{
        "index": {
          "_id": "PAYMENT-foo-XXX",
          "_index": "ledger"
        }
      },
      {
        "data": {
          "id": "XXX",
          "reference": "YYY",
          "provider": "stripe"
        },
        "indexed": {
          "provider": "stripe",
          "reference": "YYY",
          "scheme": null,
          "type": null,
          "status": null
        },
        "kind": "PAYMENT",
        "when": "2022-03-16T13:11:38.47608275Z"
      }]
